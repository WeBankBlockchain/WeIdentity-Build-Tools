webpackJsonp([13],{"CgC/":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("aA9S"),l=i.n(a),r=i("/p82"),o={data:function(){return{form:{caCrtFileName:"",nodeKeyFile:"",nodeCrtFileName:"",nodeCrtFile:"",nodeKeyFileName:"",caCrtFile:"",gmCaCrtFileName:"",gmCaCrtFile:"",gmSdkCrtFileName:"",gmSdkCrtFile:"",gmSdkKeyFileName:"",gmSdkKeyFile:"",gmenSdkCrtFileName:"",gmenSdkCrtFile:"",gmenSdkKeyFileName:"",gmenSdkKeyFile:"",encrypt_type:0,org_id:"",amop_id:"",blockchain_address:"",blockchain_fiscobcos_version:""},dialog:{checkDetailVisible:!1,checkMessages:[],nextBtn:null}}},methods:{chooseFile:function(t,e){var i=this,a=document.getElementById(t);a.value="",a.click(),a.onchange=function(a){if(a.target.files[0]){var l=a.target.files[0],r=l.name;if(r!==e)return void i.$alert("文件选择错误,请选择名为 "+e+" 的文件!","温馨提示",{}).catch(function(){});"caCrtFile"===t?(i.form.caCrtFileName=r,i.form.caCrtFile=l):"nodeCrtFile"===t?(i.form.nodeCrtFileName=r,i.form.nodeCrtFile=l):"nodeKeyFile"===t?(i.form.nodeKeyFileName=r,i.form.nodeKeyFile=l):"gmCaCrtFile"===t?(i.form.gmCaCrtFileName=r,i.form.gmCaCrtFile=l):"gmSdkCrtFile"===t?(i.form.gmSdkCrtFileName=r,i.form.gmSdkCrtFile=l):"gmSdkKeyFile"===t?(i.form.gmSdkKeyFileName=r,i.form.gmSdkKeyFile=l):"gmenSdkCrtFile"===t?(i.form.gmenSdkCrtFileName=r,i.form.gmenSdkCrtFile=l):"gmenSdkKeyFile"===t&&(i.form.gmenSdkKeyFileName=r,i.form.gmenSdkKeyFile=l)}}},checkNode:function(){var t=this;this.dialog.checkDetailVisible=!0,this.dialog.checkMessages.push("节点配置检测中..."),r.a.doGet("checkNode").then(function(e){t.dialog.checkDetailVisible=!0,t.enableBtn(t.dialog.nextBtn),0===e.data.errorCode?(t.dialog.checkMessages.push("节点配置检测成功。"),t.dialog.checkMessages.push("提示：目前暂不支持修改配置动态实时生效，修改配置需重启服务才能生效。")):t.dialog.checkMessages.push("节点配置检测失败。")})},checkInput:function(){if(""===this.form.org_id)return this.$alert("请输入机构名!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.amop_id)return this.$alert("请输入通信ID名!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.blockchain_address)return this.$alert("请输入区块链节点 IP 和 Channel 端口!","温馨提示",{}).catch(function(){}),!1;if("0"===this.form.encrypt_type){if(""===this.form.caCrtFile&&"false"===!this.form["ca.crt"])return this.$alert("请选择 ca.crt 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.nodeCrtFile&&"false"===!this.form["node.crt"])return this.$alert("请选择 node.crt 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.nodeKeyFile&&"false"===!this.form["node.key"])return this.$alert("请选择 node.key 证书文件!","温馨提示",{}).catch(function(){}),!1}else{if(""===this.form.gmCaCrtFile&&"false"===!this.form["gmCa.crt"])return this.$alert("请选择 gmCa.crt 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.gmSdkCrtFile&&"false"===!this.form["gmSdk.crt"])return this.$alert("请选择 gmSdk.crt 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.gmSdkKeyFile&&"false"===!this.form["gmSdk.key"])return this.$alert("请选择 gmSdk.key 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.gmenSdkCrtFile&&"false"===!this.form["gmenSdk.crt"])return this.$alert("请选择 gmenSdk.crt 证书文件!","温馨提示",{}).catch(function(){}),!1;if(""===this.form.gmenSdkKeyFile&&"false"===!this.form["gmenSdk.key"])return this.$alert("请选择 gmenSdk.key 证书文件!","温馨提示",{}).catch(function(){}),!1}return!0},nodeConfigUpload:function(t){var e=this;if(this.checkInput()){var i=new FormData;"0"===this.form.encrypt_type?(i.append("file",this.form.caCrtFile),i.append("file",this.form.nodeCrtFile),i.append("file",this.form.nodeKeyFile)):(i.append("file",this.form.gmCaCrtFile),i.append("file",this.form.gmSdkCrtFile),i.append("file",this.form.gmSdkKeyFile),i.append("file",this.form.gmenSdkCrtFile),i.append("file",this.form.gmenSdkKeyFile)),i.append("orgId",this.form.org_id),i.append("amopId",this.form.amop_id),i.append("version",this.form.blockchain_fiscobcos_version),i.append("encryptType",this.form.encrypt_type),i.append("ipPort",this.form.blockchain_address),this.dialog.nextBtn=t.currentTarget,this.dialog.checkMessages=[],this.dialog.checkDetailVisible=!0,this.dialog.checkMessages.push("节点配置提交中..."),this.disableBtn(this.dialog.nextBtn),r.a.doPostAndUploadFile("nodeConfigUpload",i,10).then(function(t){0===t.data.errorCode?(e.dialog.checkMessages.push("节点配置提交成功。"),e.checkNode()):(e.dialog.checkMessages.push("节点配置提交失败。"),e.enableBtn(e.dialog.nextBtn))})}},init:function(){var t=this;r.a.doGet("loadConfig").then(function(e){0===e.data.errorCode&&(t.form=l()(t.form,e.data.result))})}},created:function(){this.init()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content section_main"},[a("div",{staticClass:"box",staticStyle:{width:"70%","margin-left":"200px"}},[a("div",{staticClass:"card card-primary warning_box"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body"},[a("el-form",{ref:"form",attrs:{"label-position":"right",model:t.form,"label-width":"220px","inline-message":"true"}},[a("el-form-item",{attrs:{label:"机构名称:",prop:"org_id"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"Enter orgId",maxlength:"30",onkeyup:"this.value=this.value.replace(/[^a-zA-Z0-9]/g,'')"},on:{blur:function(e){t.form.org_id=e.target.value}},model:{value:t.form.org_id,callback:function(e){t.$set(t.form,"org_id",e)},expression:"form.org_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"通讯ID:",prop:"amop_id"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"Enter amopId",maxlength:"30",onkeyup:"this.value=this.value.replace(/[^a-zA-Z0-9]/g,'')"},on:{blur:function(e){t.form.amop_id=e.target.value}},model:{value:t.form.amop_id,callback:function(e){t.$set(t.form,"amop_id",e)},expression:"form.amop_id"}}),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("div",[t._v("此ID用于链上AMOP通讯")])])],1),t._v(" "),a("el-form-item",{attrs:{label:"国密/非国密:",prop:"encrypt_type"}},[a("el-select",{staticStyle:{width:"72%"},attrs:{placeholder:"国密/非国密"},model:{value:t.form.encrypt_type,callback:function(e){t.$set(t.form,"encrypt_type",e)},expression:"form.encrypt_type"}},[a("el-option",{attrs:{label:"非国密",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"国密",value:"1"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"区块链节点 IP 和 Channel 端口:",prop:"blockchain_address"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"IP:PORT,IP:PORT",maxlength:"30",onKeyUp:"value=value=value.replace(/[^0-9：:，,。.]/g,'');value=value.replace(/[。]/g,'.');value=value.replace(/[：]/g,':');value=value.replace(/\\s+/g,'');value=value.replace(/[，]/g,',');"},on:{blur:function(e){t.form.blockchain_address=e.target.value}},model:{value:t.form.blockchain_address,callback:function(e){t.$set(t.form,"blockchain_address",e)},expression:"form.blockchain_address"}}),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("div",[t._v('例如：10.10.4.1:20200；如果多个节点，则请用半角逗号","分割：10.10.4.1:20200,10.10.4.2:20200')]),t._v(" "),a("div",[t._v('如果"运行 WeIdentity SDK 的 Server"与区块链节点部署在同一台机器，IP可以使用127.0.0.1')])])],1),t._v(" "),"0"===t.form.encrypt_type?a("div",{attrs:{id:"ecdsa"}},[a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"ca.crt证书:",prop:"caCrtFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter caCrtFile",maxlength:"30",readOnly:""},model:{value:t.form.caCrtFileName,callback:function(e){t.$set(t.form,"caCrtFileName",e)},expression:"form.caCrtFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("caCrtFile","ca.crt")}}},[t._v("选择文件")]),t._v(" "),t.form["ca.crt"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"caCrtFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"node.crt证书:",prop:"nodeCrtFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter nodeCrtFile",maxlength:"30",readOnly:""},model:{value:t.form.nodeCrtFileName,callback:function(e){t.$set(t.form,"nodeCrtFileName",e)},expression:"form.nodeCrtFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("nodeCrtFile","node.crt")}}},[t._v("选择文件")]),t._v(" "),t.form["node.crt"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"nodeCrtFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"node.key证书:",prop:"nodeKeyFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter nodeKeyFile",maxlength:"30",readOnly:""},model:{value:t.form.nodeKeyFileName,callback:function(e){t.$set(t.form,"nodeKeyFileName",e)},expression:"form.nodeKeyFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("nodeKeyFile","node.key")}}},[t._v("选择文件")]),t._v(" "),t.form["node.key"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"nodeKeyFile"}})],1)]):t._e(),t._v(" "),"1"===t.form.encrypt_type?a("div",{staticClass:"form-group",attrs:{id:"sm2"}},[a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"gmca.crt证书:",prop:"gmCaCrtFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter gmCaCrtFile",maxlength:"30",readOnly:""},model:{value:t.form.gmCaCrtFileName,callback:function(e){t.$set(t.form,"gmCaCrtFileName",e)},expression:"form.gmCaCrtFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("gmCaCrtFile","gmCa.crt")}}},[t._v("选择文件")]),t._v(" "),t.form["gmCa.crt"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"gmCaCrtFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"gmsdk.crt证书:",prop:"gmSdkCrtFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter gmSdkCrtFile",maxlength:"30",readOnly:""},model:{value:t.form.gmSdkCrtFileName,callback:function(e){t.$set(t.form,"gmSdkCrtFileName",e)},expression:"form.gmSdkCrtFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("gmSdkCrtFile","gmSdk.crt")}}},[t._v("选择文件")]),t._v(" "),t.form["gmSdk.crt"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"gmSdkCrtFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"gmsdk.key证书:",prop:"gmSdkKeyFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter gmSdkKeyFile",maxlength:"30",readOnly:""},model:{value:t.form.gmSdkKeyFileName,callback:function(e){t.$set(t.form,"gmSdkKeyFileName",e)},expression:"form.gmSdkKeyFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("gmSdkKeyFile","gmSdk.key")}}},[t._v("选择文件")]),t._v(" "),t.form["gmSdk.key"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"gmSdkKeyFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"gmensdk.crt证书:",prop:"gmenSdkCrtFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter gmenSdkCrtFile",maxlength:"30",readOnly:""},model:{value:t.form.gmenSdkCrtFileName,callback:function(e){t.$set(t.form,"gmenSdkCrtFileName",e)},expression:"form.gmenSdkCrtFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("gmenSdkCrtFile","gmenSdk.crt")}}},[t._v("选择文件")]),t._v(" "),t.form["gmenSdk.crt"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"gmenSdkCrtFile"}})],1),t._v(" "),a("div",{staticClass:"file_part"},[a("el-form-item",{attrs:{label:"gmensdk.key证书:",prop:"gmenSdkKeyFileName"}},[a("div",{staticClass:"input_item"},[a("el-input",{staticStyle:{width:"52%"},attrs:{placeholder:"Enter gmenSdkKeyFile",maxlength:"30",readOnly:""},model:{value:t.form.gmenSdkKeyFileName,callback:function(e){t.$set(t.form,"gmenSdkKeyFileName",e)},expression:"form.gmenSdkKeyFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("gmenSdkKeyFile","gmenSdk.key")}}},[t._v("选择文件")]),t._v(" "),t.form["gmenSdk.key"]?a("div",{staticClass:"mark-bottom mark-red"},[a("div",[t._v("该证书已存在，重新上传将被覆盖。")])]):t._e()],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"gmenSdkKeyFile"}})],1)]):t._e(),t._v(" "),a("div",{staticStyle:{"text-align":"left","padding-left":"26%"}},[a("a",{attrs:{href:"https://fisco-bcos-documentation.readthedocs.io/zh_CN/latest/docs/enterprise_tools/operation.html#get-sdk-file",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),t._v(" "),a("span",{staticStyle:{color:"#017CFF","font-size":"12px"},attrs:{clas:"",s:"icon_question"}},[t._v("如何获取证书?")])])])],1),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"node_part"},[a("el-button",{staticClass:"btn btn_150",attrs:{type:"primary"},on:{click:function(e){return t.nodeConfigUpload(e)}}},[t._v("完成")])],1)],1)])]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"温馨提示",width:"400px",visible:t.dialog.checkDetailVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"checkDetailVisible",e)}}},[a("div",{staticClass:"dialog-body deployMessage"},t._l(t.dialog.checkMessages,function(e){return a("p",{key:e.value},[t._v(t._s(e))])}),0),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(e){t.dialog.checkDetailVisible=!1}}},[t._v("完成")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header card-title"},[e("h3",[this._v("区块链节点配置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sql_warning bg_color",staticStyle:{right:"-160px"}},[e("a",{staticStyle:{display:"block"},attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/deploy-via-web.html#id4",target:"blank_"}},[e("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),this._v(" "),e("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[this._v("点击查看配置配置教程")])])])}]},s=i("C7Lr")(o,n,!1,null,null,null);e.default=s.exports}});