webpackJsonp([22],{M6ow:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("/p82"),i={data:function(){return{roleType:localStorage.getItem("roleType"),dbForm:{persistence_type:"",mysql_address:"",mysql_database:"",mysql_username:"",mysql_password:"",redis_address:"",redis_password:""},dialog:{checkDetailVisible:!1,checkMessages:[],nextBtn:null,checkStatus:!1}}},methods:{checkInput:function(){if("mysql"===this.dbForm.persistence_type){if(""===this.dbForm.mysql_address)return this.$alert("请输入数据库 IP 和 PORT !","温馨提示",{}).catch(function(){}),!1;if(""===this.dbForm.mysql_database)return this.$alert("请输入数据库名称!","温馨提示",{}).catch(function(){}),!1;if(""===this.dbForm.mysql_username)return this.$alert("请输入数据库用户名!","温馨提示",{}).catch(function(){}),!1;if(""===this.dbForm.mysql_password)return this.$alert("请输入数据库密码!","温馨提示",{}).catch(function(){}),!1}else if(""===this.dbForm.redis_address)return this.$alert("请输入Redis的服务 IP 和 PORT !","温馨提示",{}).catch(function(){}),!1;return!0},setGuideStatus:function(){var t=this;a.a.doPost("setGuideStatus",{step:"5"}).then(function(e){localStorage.setItem("step",""),t.$router.push({name:"deployWeId"})})},checkOrgId:function(){var t=this;a.a.doPost("checkOrgId",{}).then(function(e){0===e.data.errorCode&&(1===e.data.result?t.setGuideStatus():0===e.data.result?(localStorage.setItem("step",4),t.$router.push({name:"step4"})):t.$alert("程序出现异常，请查看日志。","温馨提示",{}).catch(function(){}))})},checkPersistence:function(){var t=this;this.dialog.checkDetailVisible=!0,this.dialog.checkMessages.push("数据库配置检测中..."),a.a.doGet("checkPersistence").then(function(e){t.dialog.checkDetailVisible=!0,t.enableBtn(t.dialog.nextBtn),e.data.result?(t.dialog.checkStatus=!0,t.dialog.checkMessages.push("数据库配置检测成功。"),t.dialog.checkMessages.push("请继续操作。")):t.dialog.checkMessages.push("数据库配置检测失败。")})},jump:function(){this.checkOrgId()},submitDbConfig:function(){var t=this;this.checkInput()&&(this.dialog.checkMessages=[],this.dialog.checkStatus=!1,this.dialog.checkDetailVisible=!0,this.dialog.checkMessages.push("数据库配置提交中..."),this.disableBtn(this.dialog.nextBtn),a.a.doPost("submitDbConfig",this.dbForm).then(function(e){t.dialog.checkDetailVisible=!0,0===e.data.errorCode?(t.dialog.checkMessages.push("数据库配置提交成功。"),t.checkPersistence()):(t.dialog.checkMessages.push("数据库配置提交失败。"),t.enableBtn(t.dialog.nextBtn))}))},next:function(t){this.dialog.nextBtn=t.currentTarget,this.submitDbConfig()},prev:function(){localStorage.setItem("step",2),this.$router.push({name:"step2"})},init:function(){var t=this;a.a.doGet("loadConfig").then(function(e){0===e.data.errorCode&&(t.dbForm=e.data.result,"mysql"!==t.dbForm.persistence_type&&"redis"!==t.dbForm.persistence_type&&(t.dbForm.persistence_type="mysql"))}),this.$alert("<p>如果您需要使用到下列功能，则需要配置数据库<br/>1.Transportation相关组件功能<br/>2.Evidence异步存证功能<br/>3.Persistence数据存储功能(例如：存储Credential)</p>","温馨提示",{dangerouslyUseHTMLString:!0}).catch(function(){})}},mounted:function(){this.init()},created:function(){this.checkStep()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app_view_content"},[a("div",{staticClass:"app_view_register"},[a("section",{staticClass:"content"},[a("div",{staticClass:"guide_step_part box"},[a("div",{staticClass:"bottom_line"}),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),"1"==t.roleType?a("div",{staticClass:"guide_step_item"},[a("span",[t._v("5")]),t._v(" "),a("img",{attrs:{src:s("LyBL"),alt:""}}),t._v(" "),a("p",{staticStyle:{width:"200px",left:"-89px"}},[t._v("部署WeIdentity智能合约")])]):t._e()]),t._v(" "),a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"box"},[a("div",{staticClass:"card card-primary warning_box"},[t._m(4),t._v(" "),a("el-form",{ref:"dbForm",attrs:{"label-position":"right",model:t.dbForm,"label-width":"220px"}},[a("el-form-item",{attrs:{label:"数据库类型:",prop:"persistence_type"}},[a("el-select",{staticStyle:{width:"72%"},attrs:{placeholder:"数据库类型"},model:{value:t.dbForm.persistence_type,callback:function(e){t.$set(t.dbForm,"persistence_type",e)},expression:"dbForm.persistence_type"}},[a("el-option",{attrs:{label:"mysql",value:"mysql"}}),t._v(" "),a("el-option",{attrs:{label:"redis",value:"redis"}})],1),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("span",[t._v("目前暂只支持MySql与Redis数据库")])])],1),t._v(" "),"mysql"===t.dbForm.persistence_type?a("div",{attrs:{id:"mysqlForm"}},[a("el-form-item",{attrs:{label:"数据库IP:PORT:",prop:"mysql_address"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"IP:PORT",onKeyUp:"value=value=value.replace(/[^0-9：:。.]/g,'');value=value.replace(/[。]/g,'.');value=value.replace(/[：]/g,':');value=value.replace(/\\s+/g,'');"},on:{blur:function(e){t.dbForm.mysql_address=e.target.value}},model:{value:t.dbForm.mysql_address,callback:function(e){t.$set(t.dbForm,"mysql_address",e)},expression:"dbForm.mysql_address"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数据库名称:",prop:"mysql_database"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"Enter DataBase Name"},model:{value:t.dbForm.mysql_database,callback:function(e){t.$set(t.dbForm,"mysql_database",e)},expression:"dbForm.mysql_database"}}),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("span",[t._v("* 数据库需要提前自己搭建好，并建立好数据库，数据库名称(DataBase Name)可以自行决定")])])],1),t._v(" "),a("el-form-item",{attrs:{label:"数据库用户名:",prop:"mysql_username"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"Enter username"},model:{value:t.dbForm.mysql_username,callback:function(e){t.$set(t.dbForm,"mysql_username",e)},expression:"dbForm.mysql_username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"数据库密码:",prop:"mysql_password"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{type:"password",placeholder:"Enter password"},model:{value:t.dbForm.mysql_password,callback:function(e){t.$set(t.dbForm,"mysql_password",e)},expression:"dbForm.mysql_password"}})],1)],1):t._e(),t._v(" "),"redis"===t.dbForm.persistence_type?a("div",{attrs:{id:"redisForm"}},[a("el-form-item",{attrs:{label:"服务器IP:PORT:",prop:"redis_address"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{placeholder:"IP:PORT,IP:PORT",onKeyUp:"value=value=value.replace(/[^0-9：:，,。.]/g,'');value=value.replace(/[。]/g,'.');value=value.replace(/[：]/g,':');value=value.replace(/\\s+/g,'');value=value.replace(/[，]/g,',');"},on:{blur:function(e){t.dbForm.redis_address=e.target.value}},model:{value:t.dbForm.redis_address,callback:function(e){t.$set(t.dbForm,"redis_address",e)},expression:"dbForm.redis_address"}}),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("span",[t._v('如：127.0.0.1:6379 ；如果多个节点，则请用半角逗号","分割：127.0.0.1:7100,127.0.0.1:7101')])])],1),t._v(" "),a("el-form-item",{attrs:{label:"服务器密码（选填):",prop:"redis_password"}},[a("el-input",{staticStyle:{width:"72%"},attrs:{type:"password",placeholder:"Enter password"},model:{value:t.dbForm.redis_password,callback:function(e){t.$set(t.dbForm,"redis_password",e)},expression:"dbForm.redis_password"}}),t._v(" "),a("div",{staticClass:"mark-bottom"},[a("span",[t._v("如未设置密码可不填写")])])],1)],1):t._e(),t._v(" "),a("div",{staticClass:"bt-part"},[a("el-button",{staticClass:"btn btn_150",attrs:{type:"primary"},on:{click:t.prev}},[t._v("上一步")]),t._v(" "),a("el-button",{staticClass:"btn btn_150",attrs:{type:"primary"},on:{click:t.jump}},[t._v("跳过")]),t._v(" "),a("el-button",{staticClass:"btn btn_150",attrs:{type:"primary"},on:{click:function(e){return t.next(e)}}},[t._v("下一步")])],1)],1),t._v(" "),t._m(5)],1)])])])]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"温馨提示",width:"400px",visible:t.dialog.checkDetailVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"checkDetailVisible",e)}}},[a("div",{staticClass:"dialog-body deployMessage"},t._l(t.dialog.checkMessages,function(e){return a("p",{key:e.value},[t._v(t._s(e))])}),0),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary",disabled:!t.dialog.checkStatus},on:{click:t.checkOrgId}},[t._v("下一步")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"guide_step_item guide_step_complated"},[e("span",[this._v("1")]),this._v(" "),e("img",{attrs:{src:s("LyBL"),alt:""}}),this._v(" "),e("p",[this._v("区块链节点配置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"guide_step_item guide_step_complated"},[e("span",[this._v("2")]),this._v(" "),e("img",{attrs:{src:s("LyBL"),alt:""}}),this._v(" "),e("p",[this._v("设置主群组")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"guide_step_item guide_step_active"},[e("span",[this._v("3")]),this._v(" "),e("img",{attrs:{src:s("LyBL"),alt:""}}),this._v(" "),e("p",[this._v("数据库配置(可选)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"guide_step_item"},[e("span",[this._v("4")]),this._v(" "),e("img",{attrs:{src:s("LyBL"),alt:""}}),this._v(" "),e("p",[this._v("创建管理员WeID")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("h3",[this._v("配置数据库")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sql_warning"},[a("div",{staticClass:"warning_title"},[t._v("温馨提示")]),t._v(" "),a("p",[t._v("如果您需要使用到下列功能，则需要配置数据库")]),t._v(" "),a("p",[t._v("1.Transportation相关组件功能")]),t._v(" "),a("p",[t._v("2.Evidence异步存证功能")]),t._v(" "),a("p",[t._v("3.Persistence数据存储功能(例如：存储Credential)")]),t._v(" "),a("p",[a("a",{staticStyle:{display:"block"},attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/deploy-via-web.html?highlight=配置数据库#db-configuration",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:s("JaJV"),alt:""}}),t._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[t._v("配置教程")])])]),t._v(" "),a("p",[a("a",{staticStyle:{display:"block"},attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/how-to-use-persistence.html",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:s("JaJV"),alt:""}}),t._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[t._v("使用教程")])])])])}]},l=s("C7Lr")(i,r,!1,null,null,null);e.default=l.exports}});