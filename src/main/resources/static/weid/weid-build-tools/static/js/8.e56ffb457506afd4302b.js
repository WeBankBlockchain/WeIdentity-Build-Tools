webpackJsonp([8],{OKfr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("lC5x"),l=i.n(a),o=i("J0Oq"),s=i.n(o),r=i("/p82"),n=i("gej+"),d={data:function(){return{page:{weidList:[],pageSize:6,total:0,pageIndex:1},roleType:localStorage.getItem("roleType"),dialog:{dialogCreateWeIdVisible:!1,dialogCreateWeIdByPrivateVisible:!1,dialogCreateWeIdByPublicVisible:!1,dialogissuerFormVisible:!1,dialogwhiteFormVisible:!1,showWeIdVisible:!1,createByPrivateForm:{privateKeyFileName:"",privateKeyFile:""},createByPublicForm:{publicKeyFileName:"",publicKeyFile:""},registForm:{name:"",weId:"",description:""},whiteListForm:{issuerType:"",weId:""},hashWihteList:!1,whiteList:[],showData:{weId:"",hasPath:!1}}}},methods:{showAll:function(t,e){var i=this;this.dialog.showData.weId=t,this.dialog.showData.hasPath=!1,r.a.doGet("getWeIdPath").then(function(a){if(0===a.data.errorCode){if(null!==e){var l=a.data.result+"/"+t.split(":")[3];i.dialog.showData.path=l,i.dialog.showData.hasPath=!0}i.dialog.showWeIdVisible=!0}})},selectCopy:function(t){t.currentTarget.select(),document.execCommand("Copy"),this.$message({message:"已复制",type:"success",duration:1e3})},showCreateWeId:function(){n.a.data.nodeStatus?this.dialog.dialogCreateWeIdVisible=!0:n.a.checkNodeState(!0)},showCreateWeIdByPri:function(){this.dialog.createByPrivateForm.privateKeyFileName="",this.dialog.dialogCreateWeIdByPrivateVisible=!0},showCreateWeIdByPub:function(){this.dialog.createByPublicForm.publicKeyFileName="",this.dialog.dialogCreateWeIdByPublicVisible=!0},showRegistIssuer:function(t){this.dialog.registForm.weId=t,this.dialog.registForm.name="",this.dialog.registForm.description="",this.dialog.dialogissuerFormVisible=!0},registerIssuer:function(){var t=this;""!==this.dialog.registForm.name?0!==this.dialog.registForm.name.indexOf("@")?r.a.doPost("registerIssuer",this.dialog.registForm).then(function(e){0===e.data.errorCode?(t.$alert("权威凭证发行者注册成功!","温馨提示",{}).then(function(){t.dialog.dialogissuerFormVisible=!1}).catch(function(){}),t.page.weidList.forEach(function(e){e.weId===t.dialog.registForm.weId&&(e.issuer=!0)})):t.$alert(e.data.errorMessage,"温馨提示",{}).catch(function(){})}):this.$alert("权威机构名称输入非法!","温馨提示",{}).catch(function(){}):this.$alert("请输入权威机构名称!","温馨提示",{}).catch(function(){})},showRegistWhiteList:function(t){this.dialog.whiteListForm.weId=t,this.dialog.dialogwhiteFormVisible=!0},addWeIdToWhiteList:function(){var t=this;r.a.doPost("addIssuerIntoIssuerType",this.dialog.whiteListForm).then(function(e){0===e.data.errorCode?t.$alert("添加白名单成功!","温馨提示",{}).then(function(){t.dialog.dialogwhiteFormVisible=!1}).catch(function(){}):t.$alert(e.data.errorMessage,"温馨提示",{}).catch(function(){})})},changeRoleType:function(){this.roleType=localStorage.getItem("roleType")},toAddWihte:function(){this.$router.push({name:"whiteList"}),this.resetSetItem("menu2",4)},chooseFile:function(t){var e=this,i=document.getElementById(t);i.value="",i.click(),i.onchange=function(i){i.target.files[0]&&("privateKeyFile"===t?(e.dialog.createByPrivateForm.privateKeyFileName=i.target.files[0].name,e.dialog.createByPrivateForm.privateKeyFile=i.target.files[0]):"publicKeyFile"===t&&(e.dialog.createByPublicForm.publicKeyFileName=i.target.files[0].name,e.dialog.createByPublicForm.publicKeyFile=i.target.files[0]))}},createBySys:function(){var t=this;r.a.doGet("createWeId").then(function(e){0===e.data.errorCode?(t.$alert("WeID创建成功!","温馨提示",{}).then(function(){t.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),t.init()):t.$alert(e.data.errorMessage,"温馨提示",{}).catch(function(){})})},createByPri:function(){var t=this;if(""!==this.dialog.createByPrivateForm.privateKeyFile){var e=new FormData;e.append("privateKey",this.dialog.createByPrivateForm.privateKeyFile),r.a.doPostAndUploadFile("createWeIdByPrivateKey",e).then(function(e){0===e.data.errorCode?(t.$alert("WeID创建成功!","温馨提示",{}).then(function(){t.dialog.dialogCreateWeIdByPrivateVisible=!1,t.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),t.init(),t.dialog.createByPrivateForm.privateKeyFile="",t.dialog.createByPrivateForm.privateKeyFileName=""):t.$alert(e.data.errorMessage,"温馨提示",{}).catch(function(){})})}else this.$alert("请选择私钥文件!","温馨提示",{}).catch(function(){})},createByPub:function(){var t=this;if(""!==this.dialog.createByPublicForm.publicKeyFile){var e=new FormData;e.append("publicKey",this.dialog.createByPublicForm.publicKeyFile),r.a.doPostAndUploadFile("createWeIdByPublicKey",e).then(function(e){0===e.data.errorCode?(t.$alert("WeID创建成功!","温馨提示",{}).then(function(){t.dialog.dialogCreateWeIdByPublicVisible=!1,t.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),t.init(),t.dialog.createByPublicForm.publicKeyFile="",t.dialog.createByPublicForm.publicKeyFileName=""):t.$alert(e.data.errorMessage,"温馨提示",{}).catch(function(){})})}else this.$alert("请选择公钥文件!","温馨提示",{}).catch(function(){})},indexChange:function(t){var e,i,a,l=this.page.pageIndex;this.page.pageIndex=t,l>this.page.pageIndex?(e=this.page.weidList[0].weIdPojo.currentBlockNum,i=this.page.weidList[0].weIdPojo.index+1,a=!1):(e=this.page.weidList[this.page.weidList.length-1].weIdPojo.currentBlockNum,i=this.page.weidList[this.page.weidList.length-1].weIdPojo.index-1,a=!0),this.queryWeIdList(this.page.pageIndex,e,i,a)},queryWeIdList:function(t,e,i,a){var l=this,o={};o.blockNumber=e,o.pageSize=this.page.pageSize,o.indexInBlock=i,o.direction=a,o.iDisplayStart=t*this.page.pageSize,o.iDisplayLength=this.page.pageSize,r.a.doGet("getWeIdList",o).then(function(t){0===t.data.errorCode&&(l.page.weidList=t.data.result.dataList,l.page.total=t.data.result.allCount)})},init:function(){this.page.pageIndex=1,this.queryWeIdList(1,0,0,!0)},initWihteList:function(){var t=this;r.a.doGet("getIssuerTypeList").then(function(e){0===e.data.errorCode&&(t.dialog.whiteList=e.data.result,t.dialog.whiteList.length>0&&(t.dialog.hashWihteList=!0,t.dialog.whiteListForm.issuerType=t.dialog.whiteList[0].type))})},dateFormat:function(t){return new Date(parseInt(1e3*t.weIdPojo.created)+288e5).toJSON().substr(0,19).replace("T"," ")},check:function(){var t=this;return s()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.checkNodeState(!0);case 2:n.a.data.nodeStatus&&(t.init(),t.initWihteList());case 3:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;window.addEventListener("setItem",function(){t.changeRoleType()}),this.check()}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content app_main"},[a("el-row",{staticClass:"app_main_header_row"},[a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"btn",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.showCreateWeId}},[t._v("创建WeID")])],1),t._v(" "),a("el-col",{staticClass:"head-icon",attrs:{span:21}},[a("a",{attrs:{target:"blank",href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/terminologies.html?highlight=简称WeID"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),t._v(" "),a("span",{staticClass:"icon_question"},[t._v("什么是WeID?")])])])],1),t._v(" "),a("div",{staticClass:"app_view"},[a("el-table",{attrs:{data:t.page.weidList,border:"true",align:"center"}},[a("el-table-column",{attrs:{prop:"weId",label:"WeID",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"long_words link",attrs:{title:e.row.weId},on:{click:function(i){return t.showAll(e.row.weId,e.row.id)}}},[t._v(t._s(e.row.weId))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",formatter:t.dateFormat,width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"btn",staticStyle:{width:"180px"},attrs:{type:"primary",disabled:e.row.issuer},on:{click:function(i){return t.showRegistIssuer(e.row.weId)}}},[t._v("注册为权威凭证发行者")]),t._v(" "),"1"===t.roleType?a("el-button",{staticClass:"btn",staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:function(i){return t.showRegistWhiteList(e.row.weId)}}},[t._v("添加到白名单")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.page.pageIndex,"page-size":t.page.pageSize,layout:"total, prev, slot, next",total:t.page.total},on:{"current-change":t.indexChange}},[a("span",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.page.pageIndex))])])],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialog-view",attrs:{title:"创建WeID",width:"25%",visible:t.dialog.dialogCreateWeIdVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"dialogCreateWeIdVisible",e)}}},[a("div",{staticClass:"dialog-body"},[a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(e){return t.createBySys()}}},[t._v("系统自动创建公私钥来创建WeID")])],1)],1),t._v(" "),a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(e){return t.showCreateWeIdByPri()}}},[t._v("传入私钥创建WeID")])],1)],1),t._v(" "),a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(e){return t.showCreateWeIdByPub()}}},[t._v("传入公钥，使用代理模式创建WeID")])],1)],1),t._v(" "),a("a",{staticStyle:{position:"absolute",right:"60px",top:"20px","font-size":"12px",color:"#017CFF"},attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=WeID 管理#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV")}}),t._v(" "),a("span",{staticClass:"icon_question"},[t._v("使用教程")])])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"传入私钥创建WeID",width:"30%",visible:t.dialog.dialogCreateWeIdByPrivateVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"dialogCreateWeIdByPrivateVisible",e)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:t.dialog.createByPrivateForm}},[a("div",{staticClass:"file_part",staticStyle:{"margin-top":"15px"}},[a("el-form-item",[a("div",{staticClass:"mark-text"},[a("span",[t._v("备注：支持椭圆曲线的公私钥，并且为十进制私钥数据。")]),t._v(" "),a("a",{attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=创建密钥#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),t._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[t._v("如何生成私钥？")])])]),t._v(" "),a("div",{staticClass:"input_item",staticStyle:{"margin-bottom":"-8px"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择私钥文件",maxlength:"30",readOnly:""},model:{value:t.dialog.createByPrivateForm.privateKeyFileName,callback:function(e){t.$set(t.dialog.createByPrivateForm,"privateKeyFileName",e)},expression:"dialog.createByPrivateForm.privateKeyFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("privateKeyFile")}}},[t._v("选择文件")])],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"privateKeyFile"}})],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(e){return t.createByPri()}}},[t._v("创 建")])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"传入公钥创建WeID",width:"30%",visible:t.dialog.dialogCreateWeIdByPublicVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"dialogCreateWeIdByPublicVisible",e)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:t.dialog.createByPublicForm}},[a("div",{staticClass:"file_part",staticStyle:{"margin-top":"15px"}},[a("el-form-item",[a("div",{staticClass:"mark-text"},[a("div",[t._v("* 只有联盟链委员会的管理员，才能作为代理，为其他机构创建WeID。")]),t._v(" "),a("span",[t._v("* 支持椭圆曲线的公私钥，并且为十进制私钥数据。")]),t._v(" "),a("a",{attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=创建密钥#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),t._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[t._v("如何生成公钥？")])])]),t._v(" "),a("div",{staticClass:"input_item",staticStyle:{"margin-bottom":"-8px"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择公钥文件",maxlength:"30",readOnly:""},model:{value:t.dialog.createByPublicForm.publicKeyFileName,callback:function(e){t.$set(t.dialog.createByPublicForm,"publicKeyFileName",e)},expression:"dialog.createByPublicForm.publicKeyFileName"}}),t._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(e){return t.chooseFile("publicKeyFile")}}},[t._v("选择文件")])],1)]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"publicKeyFile"}})],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(e){return t.createByPub()}}},[t._v("创 建")])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"注册权威凭证发行者",width:"31%",visible:t.dialog.dialogissuerFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"dialogissuerFormVisible",e)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:t.dialog.registForm}},[a("el-form-item",{attrs:{label:"机构的WeID","label-width":t.formLabelWidth}},[a("el-input",{attrs:{disabled:"",placeholder:"填入这个机构WeID"},model:{value:t.dialog.registForm.weId,callback:function(e){t.$set(t.dialog.registForm,"weId",e)},expression:"dialog.registForm.weId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"权威机构名称","label-width":t.formLabelWidth}},[a("div",{staticClass:"mark-text"},[a("span",[t._v("\n              输入权威机构的名称（建议由英文或者数字组成，不建议包含类似空格字符的特殊符号，也不支持中文），\n              作为类似权威机构 ID 的方式使用，例如如果机构是微众银行，则可以输入类似“webank”作为其权威机构名称\n            ")])]),t._v(" "),a("el-input",{attrs:{onkeyup:"this.value=this.value.replace(/[^a-zA-Z0-9]/g,'')",placeholder:"Enter issuer name"},on:{blur:function(e){t.dialog.registForm.name=e.target.value}},model:{value:t.dialog.registForm.name,callback:function(e){t.$set(t.dialog.registForm,"name",e)},expression:"dialog.registForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"Enter issuer description"},model:{value:t.dialog.registForm.description,callback:function(e){t.$set(t.dialog.registForm,"description",e)},expression:"dialog.registForm.description"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(e){return t.registerIssuer()}}},[t._v("注 册")])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"添加到白名单",width:"31%",visible:t.dialog.dialogwhiteFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"dialogwhiteFormVisible",e)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:t.dialog.whiteListForm}},[a("el-form-item",{attrs:{label:"WeID","label-width":t.formLabelWidth}},[a("el-input",{attrs:{disabled:"",placeholder:"填入这个机构WeID"},model:{value:t.dialog.whiteListForm.weId,callback:function(e){t.$set(t.dialog.whiteListForm,"weId",e)},expression:"dialog.whiteListForm.weId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"选择待加入的白名单","label-width":t.formLabelWidth}},[0==t.dialog.hashWihteList?a("div",{staticClass:"mark-line"},[a("span",{attrs:{href:"#"},on:{click:function(e){return t.toAddWihte()}}},[t._v("前往新增白名单")])]):t._e(),t._v(" "),a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"白名单"},model:{value:t.dialog.whiteListForm.issuerType,callback:function(e){t.$set(t.dialog.whiteListForm,"issuerType",e)},expression:"dialog.whiteListForm.issuerType"}},t._l(t.dialog.whiteList,function(t){return a("el-option",{key:t.type,attrs:{label:t.type,value:t.type}})}),1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(e){return t.addWeIdToWhiteList()}}},[t._v("添 加")])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"温馨提示",width:"500px",visible:t.dialog.showWeIdVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"showWeIdVisible",e)}}},[a("div",{staticClass:"dialog-body deployMessage",staticStyle:{"min-height":"100px"}},[a("el-form",{attrs:{model:t.dialog.showData}},[a("el-form-item",{attrs:{label:"WeID:","label-width":t.formLabelWidth}},[a("el-input",{staticClass:"select_part",attrs:{readOnly:""},on:{focus:function(e){return t.selectCopy(e)}},model:{value:t.dialog.showData.weId,callback:function(e){t.$set(t.dialog.showData,"weId",e)},expression:"dialog.showData.weId"}})],1),t._v(" "),t.dialog.showData.hasPath?a("el-form-item",{attrs:{label:"该WeID密钥存放路径:","label-width":t.formLabelWidth}},[a("el-input",{staticClass:"select_part",attrs:{type:"textarea",resize:"none",rows:"4",readOnly:""},on:{focus:function(e){return t.selectCopy(e)}},model:{value:t.dialog.showData.path,callback:function(e){t.$set(t.dialog.showData,"path",e)},expression:"dialog.showData.path"}})],1):a("el-form-item",{attrs:{label:"该WeID密钥存放路径:","label-width":t.formLabelWidth}},[a("div",{staticClass:"select_part mark-text"},[t._v("该WeID非当前系统产生")])])],1)],1)])],1)},staticRenderFns:[]},u=i("C7Lr")(d,c,!1,null,null,null);e.default=u.exports}});