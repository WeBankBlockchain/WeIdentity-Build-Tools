webpackJsonp([18],{K8xi:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("lC5x"),r=a.n(n),s=a("J0Oq"),l=a.n(s),i=a("/p82"),o=a("gej+"),u={data:function(){return{page:{evidenceAsynList:[],total:0,pageIndex:1,pageSize:7},queryForm:{dataTime:"",status:"-1"},total:100,dbStatus:!1}},methods:{showDetail:function(t){this.$router.push({name:"asynEvidenceDetail",params:{dataTime:t}})},reTry:function(t){var e=this;this.$confirm("确定重试该批次吗？","温馨提示",{closeOnClickModal:!1,cancelButtonClass:"el-button--primary"}).then(function(a){var n={};n.dataTime=t,i.a.doPost("reTryAsyn",n).then(function(t){e.$alert("异步处理中，请注意查看数据。","温馨提示").catch(function(){})})}).catch(function(){})},indexChange:function(t){this.page.pageIndex=t,this.init()},init:function(){var t=this,e={};e.iDisplayStart=(this.page.pageIndex-1)*this.page.pageSize,e.iDisplayLength=this.page.pageSize;var a=this.queryForm.dataTime;a=null!==a&&""!==a?a.replace(/-/g,""):0,e.dataTime=a,e.status=this.queryForm.status,i.a.doPost("getAsyncList",e).then(function(e){0===e.data.errorCode&&(t.page.evidenceAsynList=e.data.result.dataList,t.page.total=e.data.result.allCount)})},check:function(){var t=this;return l()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.checkDbState();case 2:o.a.data.dbStatus&&(t.init(),t.dbStatus=o.a.data.dbStatus);case 3:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.check()}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content app_main"},[a("el-form",{ref:"queryForm",staticClass:"item",attrs:{model:t.queryForm,"label-width":"80px"}},[a("el-row",{staticStyle:{width:"1200px"}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"dataTime",label:"任务日期:"}},[a("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.queryForm.dataTime,callback:function(e){t.$set(t.queryForm,"dataTime",e)},expression:"queryForm.dataTime"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"status",label:"任务状态:"}},[a("el-select",{staticStyle:{width:"140px"},model:{value:t.queryForm.status,callback:function(e){t.$set(t.queryForm,"status",e)},expression:"queryForm.status"}},[a("el-option",{attrs:{label:"全部",value:"-1"}}),t._v(" "),a("el-option",{attrs:{label:"处理中",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"处理成功",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"处理失败",value:"3"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-button",{staticClass:"btn",attrs:{type:"primary",disabled:!t.dbStatus},on:{click:function(e){return t.init()}}},[t._v("查询")])],1)],1)],1),t._v(" "),a("div",{staticClass:"app_view"},[a("el-table",{attrs:{data:t.page.evidenceAsynList,border:"true",align:"center"}},[a("el-table-column",{attrs:{prop:"data_time",label:"任务日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"form_option",on:{click:function(a){return t.showDetail(e.row.data_time)}}},[t._v(t._s(e.row.data_time))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"任务状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("span",[t._v("处理中")]):2===e.row.status?a("span",[t._v("处理成功")]):3===e.row.status?a("span",[t._v("处理失败")]):a("span",[t._v("未知状态")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"all_size",label:"总记录数",align:"center",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{prop:"success_size",label:"成功数",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fail_size",label:"失败数",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.status?a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(a){return t.reTry(e.row.data_time)}}},[t._v("重试")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.page.pageIndex,"page-size":t.page.pageSize,layout:"total, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.indexChange}})],1)],1)},staticRenderFns:[]},p=a("C7Lr")(u,c,!1,null,null,null);e.default=p.exports}});