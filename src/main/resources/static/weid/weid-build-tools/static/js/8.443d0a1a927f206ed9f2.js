webpackJsonp([8],{OKfr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("lC5x"),l=i.n(a),o=i("J0Oq"),s=i.n(o),r=i("/p82"),n=i("gej+"),d={data:function(){return{page:{weidList:[],pageSize:6,total:0,pageIndex:1},roleType:localStorage.getItem("roleType"),dialog:{dialogCreateWeIdVisible:!1,dialogCreateWeIdByPrivateVisible:!1,dialogCreateWeIdByPublicVisible:!1,dialogissuerFormVisible:!1,dialogwhiteFormVisible:!1,showWeIdVisible:!1,createByPrivateForm:{privateKeyFileName:"",privateKeyFile:""},createByPublicForm:{publicKeyFileName:"",publicKeyFile:""},registForm:{name:"",weId:"",description:""},whiteListForm:{issuerType:"",weId:""},hashWihteList:!1,showData:{weId:"",hasPath:!1},page:{selectedRow:null,whiteList:[],pageIndex:1,pageSize:4,total:0}}}},methods:{showAll:function(e,t){var i=this;this.dialog.showData.weId=e,this.dialog.showData.hasPath=!1,r.a.doGet("getWeIdPath").then(function(a){if(0===a.data.errorCode){if(null!==t){var l=a.data.result+"/"+e.split(":")[3];i.dialog.showData.path=l,i.dialog.showData.hasPath=!0}i.dialog.showWeIdVisible=!0}})},selectCopy:function(e){e.currentTarget.select(),document.execCommand("Copy"),this.$message({message:"已复制",type:"success",duration:1e3})},showCreateWeId:function(){n.a.data.nodeStatus?this.dialog.dialogCreateWeIdVisible=!0:n.a.checkNodeState(!0)},showCreateWeIdByPri:function(){this.dialog.createByPrivateForm.privateKeyFileName="",this.dialog.dialogCreateWeIdByPrivateVisible=!0},showCreateWeIdByPub:function(){this.dialog.createByPublicForm.publicKeyFileName="",this.dialog.dialogCreateWeIdByPublicVisible=!0},showRegistIssuer:function(e){this.dialog.registForm.weId=e,this.dialog.registForm.name="",this.dialog.registForm.description="",this.dialog.dialogissuerFormVisible=!0},registerIssuer:function(){var e=this;""!==this.dialog.registForm.name?0!==this.dialog.registForm.name.indexOf("@")?r.a.doPost("registerIssuer",this.dialog.registForm).then(function(t){0===t.data.errorCode?(e.$alert("权威凭证发行者注册成功!","温馨提示",{}).then(function(){e.dialog.dialogissuerFormVisible=!1}).catch(function(){}),e.page.weidList.forEach(function(t){t.weId===e.dialog.registForm.weId&&(t.issuer=!0)})):e.$alert(t.data.errorMessage,"温馨提示",{}).catch(function(){})}):this.$alert("权威机构名称输入非法!","温馨提示",{}).catch(function(){}):this.$alert("请输入权威机构名称!","温馨提示",{}).catch(function(){})},showRegistWhiteList:function(e){var t=this;return s()(l.a.mark(function i(){return l.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t.dialog.whiteListForm.weId=e,t.dialog.page.pageIndex=1,i.next=4,t.queryIssueTypeList();case 4:t.dialog.dialogwhiteFormVisible=!0;case 5:case"end":return i.stop()}},i,t)}))()},addWeIdToWhiteList:function(){var e=this;null!=this.dialog.page.selectedRow?(this.dialog.whiteListForm.issuerType=this.dialog.page.selectedRow.typeName,r.a.doPost("addIssuerIntoIssuerType",this.dialog.whiteListForm).then(function(t){0===t.data.errorCode?e.$alert("添加白名单成功!","温馨提示",{}).then(function(){e.dialog.dialogwhiteFormVisible=!1}).catch(function(){}):e.$alert(t.data.errorMessage,"温馨提示",{}).catch(function(){})})):this.$alert("请选择白名单","温馨提示",{}).catch(function(){})},changeRoleType:function(){this.roleType=localStorage.getItem("roleType")},toAddWihte:function(){this.$router.push({name:"whiteList"}),this.resetSetItem("menu2",4)},chooseFile:function(e){var t=this,i=document.getElementById(e);i.value="",i.click(),i.onchange=function(i){i.target.files[0]&&("privateKeyFile"===e?(t.dialog.createByPrivateForm.privateKeyFileName=i.target.files[0].name,t.dialog.createByPrivateForm.privateKeyFile=i.target.files[0]):"publicKeyFile"===e&&(t.dialog.createByPublicForm.publicKeyFileName=i.target.files[0].name,t.dialog.createByPublicForm.publicKeyFile=i.target.files[0]))}},createBySys:function(){var e=this;r.a.doPost("createWeId").then(function(t){0===t.data.errorCode?(e.$alert("WeID创建成功!","温馨提示",{}).then(function(){e.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),e.init()):e.$alert(t.data.errorMessage,"温馨提示",{}).catch(function(){})})},createByPri:function(){var e=this;if(""!==this.dialog.createByPrivateForm.privateKeyFile){var t=new FormData;t.append("privateKey",this.dialog.createByPrivateForm.privateKeyFile),r.a.doPostAndUploadFile("createWeIdByPrivateKey",t).then(function(t){0===t.data.errorCode?(e.$alert("WeID创建成功!","温馨提示",{}).then(function(){e.dialog.dialogCreateWeIdByPrivateVisible=!1,e.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),e.init(),e.dialog.createByPrivateForm.privateKeyFile="",e.dialog.createByPrivateForm.privateKeyFileName=""):e.$alert(t.data.errorMessage,"温馨提示",{}).catch(function(){})})}else this.$alert("请选择私钥文件!","温馨提示",{}).catch(function(){})},createByPub:function(){var e=this;if(""!==this.dialog.createByPublicForm.publicKeyFile){var t=new FormData;t.append("publicKey",this.dialog.createByPublicForm.publicKeyFile),r.a.doPostAndUploadFile("createWeIdByPublicKey",t).then(function(t){0===t.data.errorCode?(e.$alert("WeID创建成功!","温馨提示",{}).then(function(){e.dialog.dialogCreateWeIdByPublicVisible=!1,e.dialog.dialogCreateWeIdVisible=!1}).catch(function(){}),e.init(),e.dialog.createByPublicForm.publicKeyFile="",e.dialog.createByPublicForm.publicKeyFileName=""):e.$alert(t.data.errorMessage,"温馨提示",{}).catch(function(){})})}else this.$alert("请选择公钥文件!","温馨提示",{}).catch(function(){})},indexChange:function(e){var t,i,a,l=this.page.pageIndex;this.page.pageIndex=e,l>this.page.pageIndex?(t=this.page.weidList[0].weIdPojo.currentBlockNum,i=this.page.weidList[0].weIdPojo.index+1,a=!1):(t=this.page.weidList[this.page.weidList.length-1].weIdPojo.currentBlockNum,i=this.page.weidList[this.page.weidList.length-1].weIdPojo.index-1,a=!0),this.queryWeIdList(this.page.pageIndex,t,i,a)},queryWeIdList:function(e,t,i,a){var l=this,o={};o.blockNumber=t,o.pageSize=this.page.pageSize,o.indexInBlock=i,o.direction=a,o.iDisplayStart=e*this.page.pageSize,o.iDisplayLength=this.page.pageSize,r.a.doGet("getWeIdList",o).then(function(e){0===e.data.errorCode&&(l.page.weidList=e.data.result.dataList,l.page.total=e.data.result.allCount)})},init:function(){this.page.pageIndex=1,this.queryWeIdList(1,0,0,!0)},queryIssueTypeList:function(){var e=this;return s()(l.a.mark(function t(){var i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).iDisplayStart=(e.dialog.page.pageIndex-1)*e.dialog.page.pageSize,i.iDisplayLength=e.dialog.page.pageSize,t.next=5,r.a.doGet("getIssuerTypeList",i).then(function(t){e.dialog.page.selectedRow=null,0===t.data.errorCode&&(e.dialog.page.whiteList=t.data.result.dataList,e.dialog.page.total=t.data.result.allCount),e.dialog.page.whiteList.length>0&&(e.dialog.hashWihteList=!0)});case 5:case"end":return t.stop()}},t,e)}))()},indexChange2:function(e){this.dialog.page.pageIndex=e,this.queryIssueTypeList()},dateFormat:function(e){return new Date(parseInt(1e3*e.weIdPojo.created)+288e5).toJSON().substr(0,19).replace("T"," ")},check:function(){var e=this;return s()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.checkNodeState(!0);case 2:n.a.data.nodeStatus&&e.init();case 3:case"end":return t.stop()}},t,e)}))()}},mounted:function(){var e=this;window.addEventListener("setItem",function(){e.changeRoleType()}),this.check()}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"content app_main"},[a("el-row",{staticClass:"app_main_header_row"},[a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"btn",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:e.showCreateWeId}},[e._v("创建WeID")])],1),e._v(" "),a("el-col",{staticClass:"head-icon",attrs:{span:21}},[a("a",{attrs:{target:"blank",href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/terminologies.html?highlight=简称WeID"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),e._v(" "),a("span",{staticClass:"icon_question"},[e._v("什么是WeID?")])])])],1),e._v(" "),a("div",{staticClass:"app_view"},[a("el-table",{attrs:{data:e.page.weidList,border:"true",align:"center"}},[a("el-table-column",{attrs:{prop:"weId",label:"WeID",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"long_words link",attrs:{title:t.row.weId},on:{click:function(i){return e.showAll(t.row.weId,t.row.id)}}},[e._v(e._s(t.row.weId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",formatter:e.dateFormat,width:"200"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",staticStyle:{width:"180px"},attrs:{type:"primary",disabled:t.row.issuer},on:{click:function(i){return e.showRegistIssuer(t.row.weId)}}},[e._v("注册为权威凭证发行者")]),e._v(" "),"1"===e.roleType?a("el-button",{staticClass:"btn",staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:function(i){return e.showRegistWhiteList(t.row.weId)}}},[e._v("添加到白名单")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.page.pageIndex,"page-size":e.page.pageSize,layout:"total, prev, slot, next",total:e.page.total},on:{"current-change":e.indexChange}},[a("span",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.page.pageIndex))])])],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialog-view",attrs:{title:"创建WeID",width:"25%",visible:e.dialog.dialogCreateWeIdVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogCreateWeIdVisible",t)}}},[a("div",{staticClass:"dialog-body"},[a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(t){return e.createBySys()}}},[e._v("系统自动创建公私钥来创建WeID")])],1)],1),e._v(" "),a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(t){return e.showCreateWeIdByPri()}}},[e._v("传入私钥创建WeID")])],1)],1),e._v(" "),a("el-row",[a("el-col",[a("el-button",{staticClass:"btn width_100",attrs:{type:"primary"},on:{click:function(t){return e.showCreateWeIdByPub()}}},[e._v("传入公钥，使用代理模式创建WeID")])],1)],1),e._v(" "),a("a",{staticStyle:{position:"absolute",right:"60px",top:"20px","font-size":"12px",color:"#017CFF"},attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=WeID 管理#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV")}}),e._v(" "),a("span",{staticClass:"icon_question"},[e._v("使用教程")])])],1)]),e._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"传入私钥创建WeID",width:"30%",visible:e.dialog.dialogCreateWeIdByPrivateVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogCreateWeIdByPrivateVisible",t)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:e.dialog.createByPrivateForm}},[a("div",{staticClass:"file_part",staticStyle:{"margin-top":"15px"}},[a("el-form-item",[a("div",{staticClass:"mark-text"},[a("span",[e._v("备注：支持椭圆曲线的公私钥，并且为十进制私钥数据。")]),e._v(" "),a("a",{attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=创建密钥#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),e._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[e._v("如何生成私钥？")])])]),e._v(" "),a("div",{staticClass:"input_item",staticStyle:{"margin-bottom":"-8px"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择私钥文件",maxlength:"30",readOnly:""},model:{value:e.dialog.createByPrivateForm.privateKeyFileName,callback:function(t){e.$set(e.dialog.createByPrivateForm,"privateKeyFileName",t)},expression:"dialog.createByPrivateForm.privateKeyFileName"}}),e._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(t){return e.chooseFile("privateKeyFile")}}},[e._v("选择文件")])],1)]),e._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"privateKeyFile"}})],1)])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(t){return e.createByPri()}}},[e._v("创 建")])],1)]),e._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"传入公钥创建WeID",width:"30%",visible:e.dialog.dialogCreateWeIdByPublicVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogCreateWeIdByPublicVisible",t)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:e.dialog.createByPublicForm}},[a("div",{staticClass:"file_part",staticStyle:{"margin-top":"15px"}},[a("el-form-item",[a("div",{staticClass:"mark-text"},[a("div",[e._v("* 只有联盟链委员会的管理员，才能作为代理，为其他机构创建WeID。")]),e._v(" "),a("span",[e._v("* 支持椭圆曲线的公私钥，并且为十进制私钥数据。")]),e._v(" "),a("a",{attrs:{href:"https://weidentity.readthedocs.io/zh_CN/latest/docs/weidentity-quick-tools-web.html?highlight=创建密钥#weid",target:"blank_"}},[a("img",{staticClass:"icon_question",attrs:{src:i("JaJV"),alt:""}}),e._v(" "),a("span",{staticClass:"icon_question",staticStyle:{color:"#017CFF","font-size":"12px",display:"inline-block"}},[e._v("如何生成公钥？")])])]),e._v(" "),a("div",{staticClass:"input_item",staticStyle:{"margin-bottom":"-8px"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请选择公钥文件",maxlength:"30",readOnly:""},model:{value:e.dialog.createByPublicForm.publicKeyFileName,callback:function(t){e.$set(e.dialog.createByPublicForm,"publicKeyFileName",t)},expression:"dialog.createByPublicForm.publicKeyFileName"}}),e._v(" "),a("button",{staticClass:"upload-btn btn btn-block btn-primary btn-flat",attrs:{type:"button"},on:{click:function(t){return e.chooseFile("publicKeyFile")}}},[e._v("选择文件")])],1)]),e._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"publicKeyFile"}})],1)])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(t){return e.createByPub()}}},[e._v("创 建")])],1)]),e._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"注册权威凭证发行者",width:"31%",visible:e.dialog.dialogissuerFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogissuerFormVisible",t)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:e.dialog.registForm}},[a("el-form-item",{attrs:{label:"机构的WeID","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",placeholder:"填入这个机构WeID"},model:{value:e.dialog.registForm.weId,callback:function(t){e.$set(e.dialog.registForm,"weId",t)},expression:"dialog.registForm.weId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权威机构名称","label-width":e.formLabelWidth}},[a("div",{staticClass:"mark-text"},[a("span",[e._v("\n              输入权威机构的名称（建议由英文或者数字组成，不建议包含类似空格字符的特殊符号，也不支持中文），\n              作为类似权威机构 ID 的方式使用，例如如果机构是微众银行，则可以输入类似“webank”作为其权威机构名称\n            ")])]),e._v(" "),a("el-input",{attrs:{onkeyup:"this.value=this.value.replace(/[^a-zA-Z0-9]/g,'')",placeholder:"Enter issuer name"},on:{blur:function(t){e.dialog.registForm.name=t.target.value}},model:{value:e.dialog.registForm.name,callback:function(t){e.$set(e.dialog.registForm,"name",t)},expression:"dialog.registForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"Enter issuer description"},model:{value:e.dialog.registForm.description,callback:function(t){e.$set(e.dialog.registForm,"description",t)},expression:"dialog.registForm.description"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(t){return e.registerIssuer()}}},[e._v("注 册")])],1)]),e._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"添加到白名单",width:"31%",visible:e.dialog.dialogwhiteFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogwhiteFormVisible",t)}}},[a("div",{staticClass:"dialog-body"},[a("el-form",{attrs:{model:e.dialog.whiteListForm}},[a("el-form-item",{attrs:{label:"WeID","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",placeholder:"填入这个机构WeID"},model:{value:e.dialog.whiteListForm.weId,callback:function(t){e.$set(e.dialog.whiteListForm,"weId",t)},expression:"dialog.whiteListForm.weId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择待加入的白名单","label-width":e.formLabelWidth}},[0==e.dialog.hashWihteList?a("div",{staticClass:"mark-line"},[a("span",{attrs:{href:"#"},on:{click:function(t){return e.toAddWihte()}}},[e._v("前往新增白名单")])]):e._e(),e._v(" "),a("el-table",{attrs:{data:e.dialog.page.whiteList,border:"true",align:"center"}},[a("el-table-column",{attrs:{label:"选择",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row},model:{value:e.dialog.page.selectedRow,callback:function(t){e.$set(e.dialog.page,"selectedRow",t)},expression:"dialog.page.selectedRow"}},[a("span")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"白名单名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"long_words",attrs:{title:t.row.typeName}},[e._v(e._s(t.row.typeName))])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.dialog.page.pageIndex,"page-size":e.dialog.page.pageSize,layout:"total, prev, pager, next, jumper",total:e.dialog.page.total},on:{"current-change":e.indexChange2}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"width_100",attrs:{type:"primary"},on:{click:function(t){return e.addWeIdToWhiteList()}}},[e._v("添 加")])],1)]),e._v(" "),a("el-dialog",{staticClass:"dialog-view",attrs:{title:"温馨提示",width:"500px",visible:e.dialog.showWeIdVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"showWeIdVisible",t)}}},[a("div",{staticClass:"dialog-body deployMessage",staticStyle:{"min-height":"100px"}},[a("el-form",{attrs:{model:e.dialog.showData}},[a("el-form-item",{attrs:{label:"WeID:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"select_part",attrs:{readOnly:""},on:{focus:function(t){return e.selectCopy(t)}},model:{value:e.dialog.showData.weId,callback:function(t){e.$set(e.dialog.showData,"weId",t)},expression:"dialog.showData.weId"}})],1),e._v(" "),e.dialog.showData.hasPath?a("el-form-item",{attrs:{label:"该WeID密钥存放路径:","label-width":e.formLabelWidth}},[a("el-input",{staticClass:"select_part",attrs:{type:"textarea",resize:"none",rows:"4",readOnly:""},on:{focus:function(t){return e.selectCopy(t)}},model:{value:e.dialog.showData.path,callback:function(t){e.$set(e.dialog.showData,"path",t)},expression:"dialog.showData.path"}})],1):a("el-form-item",{attrs:{label:"该WeID密钥存放路径:","label-width":e.formLabelWidth}},[a("div",{staticClass:"select_part mark-text"},[e._v("该WeID非当前系统产生")])])],1)],1)])],1)},staticRenderFns:[]},g=i("C7Lr")(d,c,!1,null,null,null);t.default=g.exports}});